<!doctype html>
<html lang="kk">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
    <style>
      body {
        font-size: 0.9rem;
        background: url(./img/carla_ossa_by_rivaldino-d5a6wkz.jpg) 65% top;
      }
      .table td, .table th {
        vertical-align: middle;
      }
      @media (min-width: 576px) {
        .modal-xl {
          max-width: 800px ;
        }
      }
      @media (min-width: 992px) {
        .modal-xl {
          max-width: 980px ;
        }
      }
      @media (min-width: 1010px) {
        .modal-xl {
          max-width: 1000px ;
        }
      }
    </style>
    <title>AJAX</title>
  </head>
  
  <body class="" style="padding-top: 60px;">
    <nav class="navbar fixed-top navbar-expand navbar-dark bg-dark">
      <a class="navbar-brand" href="#">DataBase</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false"
        aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="#" onclick=showmodal(2)>Home <span class="sr-only">(current)</span></a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">Деректер
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown1">
              <a class="dropdown-item" href="#" onclick="handle('', 'modal-pipe-view.html')">Перфотрубалар</a>
              <a class="dropdown-item" href="#" onclick="handle('', 'modal-auto-view.html')">Автотехникалар</a>
              <a class="dropdown-item" href="#" onclick="handle('', 'modal-oilfields-view.html')">Кен орындары</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#" onclick="handle('', 'modal-employee-view.html')">Жұмысшы мамандар</a>
            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown2" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">Құжат енгізу
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdown">
              <a class="dropdown-item" href="#" onclick="showdocinput()">Жіберілгені жайлы АКТ</a>
              <a class="dropdown-item" href="#">Қабылданғаны жайлы АКТ</a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" href="#" onclick="">Өз ара алыс-беріс жайлы АКТ</a>
            </div>
          </li>
          
        </ul>
      </div>
    </nav>

    <div class="container">
    </div>

    <div id="modal-frame"></div>
    <div id="modal-frame2"></div>
    
    

    
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
    <!-- <script src="./js/quickstart.js"></script> -->
    <script src="./js/Modal.js"></script>
    <script src="./js/Table.js"></script>
    <script src="./js/Pagination.js"></script>
    <script src="./js/Button.js"></script>
    <script>
      // I need create class
      // Модалды окноға өз алдына бір класс арнау керек. Сол класс арқылы оның ішіндегі деректерді басқара алуым керек
      // { title, BODY, buttons, coordinates }
      //      BODY: { form, tabel, pagination }

  

  // modal = new Modal();
  // modal.create();
  // modal.show();

  modal2 = new Modal({container: 'frame2', title: 'Кодпен жасалған окно', backdrop: true, animation: 'fade', centered: 'modal-dialog-centered', size: 'modal-lg' });
  modal2.create();
  // modal2.show();
  // `<button id="" type="button" class="btn btn-secondary btn-sm ${fst_btn_caption}" data-dismiss="modal">${Close}</button>` +
  // `<button id="" type="button" class="btn btn-primary btn-sm ${sec_btn_caption}">${Save}</button>` +

  $.post('/pipe-view', function (data) {
    table1 = new Table(
      { data: data, 
        head: ["Труба", "Диаметр", "Ұзындығы"],
        tdstyle: ["", "text-right", "text-right"],
        rows: 12
      });
    pagination1 = new Pagination();
    button1 = new Button({text: "Айнып қалдым"});
    button2 = new Button({style: 'btn-outline-primary', text: "Базаға сақта"});
    
    modal2.body.append(table1.create(), 'table1');
    modal2.body.append(pagination1.create(), 'pagination1');
    modal2.footer.append(button1.create(), 'button1')
    modal2.footer.append(button2.create(), 'button2')
    table1.render(1);
    pagination1.render();
    button1.render();
    button2.render();
    modal2.show();
  });

  t = new Table([{}],[]);




    </script>
    <script>
      // мына екеуі showdocinput-тікі. Құрту керек бұл жерден
      let pipes = [];
      let pipelength = [];

      // -----------------------------------------------------------------------------
      function handle(num, document) {
        num = num || '';
        let container = '#modal-frame' + num;

        event.preventDefault();       // браузердің обработкасын тоқтатамын

        $(container).load(document, function (res, sts, xhr) {
          if (sts === 'error') {
              alert('Server not response');

          } else {
              init(container);          // точка входа
          }
        });

        return false;   // негізі onclick арқылы болғанда қажеті жоқ болар деп ойлаймын
        // тексеріп қарау керек
      }

// ---------------------------------------------------------------------
      function showmodal(num) {
        num = num || '';
        let container = '#modal-frame' + num;

        event.preventDefault();       // браузердің обработкасын тоқтатамын

        $(container).load('modal-table.html', function (res, sts, xhr) {
          if (sts === 'error') {
              alert('Server not response');

          } else {
              init(container);          // точка входа

          }
        });
      }

      
      
      function showdocinput() {
        let container = '#modal-frame';

        event.preventDefault();       // браузердің обработкасын тоқтатамын

        $(container).load('modal-action.html', function (res, sts, xhr) {
          if (sts === 'error') {
              alert('Server not response');

          } else {
              init(container);          // точка входа

          }
        });

        return false;
      }
      
    </script>

  </body>
</html>
